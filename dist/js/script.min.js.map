{"version":3,"sources":["script.min.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","$","document","ready","carName","carPic","carSpeed","carDesc","carsContainer","getElementById","carBox","getElementsByClassName","scaleWidth","offsetWidth","semaphore","light","start","animTime","xml","XMLHttpRequest","open","onload","jsonData","JSON","parse","responseText","carsData","cars","distance","ratio","trafficLightsPos","traffic_lights","position","trafficLightsTime","duration","speedLimit","speed_limits","style","left","colours","current","status","data","carItem","name","image","speed","description","insertAdjacentHTML","renderCars","slSign","limitNumb","speedLimits","setInterval","background","addEventListener","this","innerHTML","match","map","Number","imgSrc","getElementsByTagName","src","table","rows","firstTd","cells","img","createElement","className","dataset","hasChildNodes","appendChild","selectCar","value","car","getAttribute","alert","onerror","send","keyup","yourtext","val","li","removeClass","filter","str","text","RegExp","test","hide","show","addClass"],"mappings":"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","file":"script.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\n\n$(document).ready(function () {\n\n    //vars\n    var url = 'data.json',\n        carsContainer = document.getElementById(\"cars-list\"),\n        search = document.getElementById(\"search\"),\n        carBox = document.getElementsByClassName(\"car-box\"),\n        scaleWidth = document.getElementById('scale').offsetWidth,\n        semaphore = document.getElementById('semaphore'),\n        light = document.getElementsByClassName('lights'),\n        start = document.getElementById('start'),\n        animTime = document.getElementById('animation-interval'),\n        carName,\n        carPic,\n        carSpeed,\n        carDesc;\n\n    //json request\n    var xml = new XMLHttpRequest();\n    xml.open('GET', url);\n    xml.onload = function () {\n\n        var jsonData = JSON.parse(xml.responseText),\n            carsData = jsonData.cars,\n            distance = jsonData.distance,\n            ratio = scaleWidth / distance,\n            trafficLightsPos = jsonData.traffic_lights[0].position * ratio,\n            trafficLightsTime = jsonData.traffic_lights[0].duration,\n            speedLimit = jsonData.speed_limits;\n\n        // add speed limit signs\n        function speedLimits(data) {\n\n            var slSign = '';\n\n            for (var i = 0; i < data.length; i++) {\n\n                var limitNumb = data[i].speed,\n                    limitPos = data[i].position * ratio;\n\n                slSign += \"<div class='speed-sign' style='left: \" + limitPos + \"px'>\" + limitNumb + \"</div>\";\n            }\n\n            document.getElementById('scale').insertAdjacentHTML('afterend', slSign);\n        }\n\n        //traffic lights\n        semaphore.style.left = trafficLightsPos;\n\n        var colours = [\"red\", \"green\"];\n        var current = colours[0];\n        function changeLights() {\n\n            if (current == colours[0]) {\n                light[0].style.background = current;\n                light[1].style.background = 'gray';\n                current = colours[1];\n            } else if (current == colours[1]) {\n                light[0].style.background = 'gray';\n                light[1].style.background = current;\n                current = colours[0];\n            }\n        }\n\n        //display data\n        if (xml.status >= 200 && xml.status < 400) {\n\n            //display cars\n            renderCars(carsData);\n\n            //display speed limit signs\n            speedLimits(speedLimit);\n\n            //traffic lights\n            setInterval(changeLights, trafficLightsTime);\n\n            //select car\n            selectCar();\n\n            //animate cars\n            animateCars();\n        } else {\n            alert(\"We connected to the server, but it returned an error.\");\n        }\n    };\n\n    xml.onerror = function () {\n        alert(\"Connection error\");\n    };\n\n    xml.send();\n\n    // get cars data and show them on the page\n    function renderCars(data) {\n        var carItem = '';\n\n        for (var i = 0; i < data.length; i++) {\n\n            carName = data[i].name;\n            carPic = data[i].image;\n            carSpeed = data[i].speed;\n            carDesc = data[i].description;\n\n            carItem += \"<li class='tb-4 bb'><div class='car-box'><div class='front'><img src=\" + carPic + \" alt='car'><span>\" + carName + \"</span></div><div class='back'><img src=\" + carPic + \" alt='car'><span>\" + carDesc + \"</span><span class='speed'>Speed: \" + carSpeed + \"</span></div></div></li>\";\n        }\n\n        carsContainer.insertAdjacentHTML('beforeend', carItem);\n    }\n\n    //filter data from input\n    $('#search').keyup(function () {\n        var yourtext = $(this).val();\n        var li = $(\"#cars-list > li.tb-4\");\n        li.removeClass('bb');\n        if (yourtext.length > 0) {\n            li.filter(function () {\n                var str = $(this).text();\n                var re = new RegExp(yourtext, \"i\");\n                var result = re.test(str);\n                if (!result) {\n                    return $(this);\n                }\n            }).hide();\n        } else {\n            li.show().addClass('bb');\n        }\n    });\n\n    //select carbox\n    function selectCar() {\n        for (var i = 0; i < carBox.length; i++) {\n\n            carBox[i].addEventListener(\"click\", function () {\n                //event.preventDefault();\n                var speed = this.getElementsByClassName('speed')[0].innerHTML.match(/\\d+/g).map(Number);\n                var imgSrc = this.getElementsByTagName('img')[0].src;\n                var table = document.getElementById('road-distance');\n\n                for (var i = 0; i < table.rows.length; i++) {\n                    var firstTd = table.rows[i].cells[0];\n                    var img = document.createElement('img');\n                    img.className = 'race-car';\n                    img.dataset.speed = speed[0];\n                    img.src = imgSrc;\n                    if (!firstTd.hasChildNodes()) firstTd.appendChild(img);\n                }\n            });\n        }\n    }\n\n    //animate cars\n    function animateCars() {\n        start.addEventListener('click', function () {\n            var interval = animTime.value,\n                car = document.getElementsByClassName('race-car');\n\n            for (var i = 0; i < car.length; i++) {\n                var carSpeed = car[i].getAttribute('data-speed');\n                car[i].style.left = \"1000%\";\n            }\n        });\n    }\n});\n\n},{}]},{},[1]);\n"]}